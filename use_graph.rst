==============
QC グラフ
==============

| qcグラフではbamファイルの品質をグラフに表示します。
|
| 先頭の背の低いグラフはbamファイルごとのdepth 平均値です。
| このグラフを範囲選択することで他のグラフの拡大ができます。
| それぞれのグラフではマウスを乗せると詳細を表示します。


.. image:: image/qc_operation.PNG
  :scale: 100%

==============
SV グラフ
==============

| svグラフでは検出したstructural variation (SV) について棒グラフと円形のグラフで表示します。
| 

* 棒グラフでは全サンプルでbreakpointを集計した数を表示します。
* 円形のグラフでは、サンプルごとにbreakpoint1と2を線でつないで表示します。

| 棒グラフを選択すると選択されたgenome領域にbreakpointを持つサンプルが選択されます。
| 選択方法は「ハイライト」と「選択したもののみ表示（他を隠す）」の2とおりあり、先頭のオプションボタンで選択できます。
|

.. image:: image/sv_operation1.PNG
  :scale: 100%


| 棒グラフを構成する要素は2つあり、SV が chromosome を超えて発生しているか、もしくは同一 chromosome 内で発生しているかで色を分けています。
| チェックを外すと、その要素は表示されません。
|

.. image:: image/sv_operation2.PNG
  :scale: 100%

| サンプルごとの円形のグラフをクリックすると拡大表示します。
| breakpointをつなぐ線の上にマウスを乗せると詳細を表示します。
|

.. image:: image/sv_operation3.PNG
  :scale: 100%

========================
mutation-matrix グラフ
========================

mutation-matrix グラフでは検出したmutation について縦軸を遺伝子(Gene), 横軸をサンプル(Sample) として、変異タイプ別に表示します。

:横長の棒グラフ(Sample):
  サンプルごとに検出されたmutationの数を表示します。

:縦長の棒グラフ(Gene):
  遺伝子ごとのmutation数をサンプル数における割合(%)で表示します。

  - 同一のサンプルが同じ遺伝子に対して複数のmutationを持っていた場合、mutation数を1としてカウントします。
  - 同一のサンプルが同じ遺伝子に対して複数の変異タイプを持っていた場合、優先順位の高い変異タイプにカウントします。

:functions:
  変異タイプ(func)別に色分けして表示します。表示したくない変異タイプがある場合、functions のチェックボックスからチェックを外すことで除外できます。

:sub plot:
  mutationとは別にサンプルに対するデータがある場合、subplotとして表示することができます。このファイルは ``pa_plot`` コマンド実行前に設定ファイルに記入しておく必要があります。

.. image:: image/mut_operation1.PNG
  :scale: 100%

**操作方法**

.. image:: image/mut_operation2.PNG
  :scale: 100%

.. image:: image/mut_operation2_2.PNG
  :scale: 100%

1. axis-X sort 
---------------

横軸の並び順を変更します。

 - none ソートしない
 - ASC 昇順
 - DESC 降順

以下の要素でソートでき、複数ソート可能です。

:SampleID: サンプルの名前順
:Mutation num.: サンプルごとのmutation数
:Genes: 遺伝子ごとの変異数　ASC/DESCどちらかを選択したのち、横のリストボックスからGene名を選択し、[add sort key] ボタンをクリックしてください。
:automatic Gantt-chart:
  自動的にGantt-chartを作成します。
  と、いっても技術者におなじみのガントチャートではありません。次で説明します。
  使用する遺伝子の数を横のエディットボックスに入力したのち、[Gantt-chart] ボタンをクリックしてください。

**Gantt-chart**

| 縦軸を遺伝子(Gene)の変異数の多い順に並べ、横軸をその遺伝子の変異を持っているかどうかで並び替えます。
| まず、先頭の遺伝子から並べ、指定された遺伝子の数だけ繰り返します。
| 検出された遺伝子の数だけ繰り返すのが理想ですが、処理が重くなるため、関心のある遺伝子までに絞ったほうが処理が早くなります。
|

.. image:: image/mut_operation3.PNG
  :scale: 100%

2. axis-Y sort
----------------

縦軸の並び順を変更します。

 - none ソートしない
 - ASC 昇順
 - DESC 降順

以下の要素でソートでき、複数ソート可能です。

:Mutation num.: 遺伝子ごとのmutation数
:Gene name: 遺伝子の名前順


3. sample filter
------------------

| 横長の棒グラフ(Sample)の縦軸の最大値を設定します。
|
| いくつかのサンプルだけ飛びぬけて変異数が多く、他はそれほど変異がないような場合、この機能を使用することで、グラフが見やすくなることがあります。
| 表示したい最大値を横のエディットボックスに入力したのち、[update filter] ボタンをクリックしてください。
| 空白にすると、すべてを表示します。（初期値）
|

**フィルター適用前と適用後**

| 最大値を200に設定した場合の表示例
| 

.. image:: image/mut_operation4.PNG
  :scale: 100%


4. genes filter
-----------------

縦軸に表示する遺伝子に対してフィルタを設定します。

:Rate: 検出された遺伝子のサンプル数における割合(%)。初期値は0%（フィルタリングなし）
:Display maximum: 表示する遺伝子の最大数。

いずれも横のエディットボックスに入力したのち、[update filter] ボタンをクリックしてください。

